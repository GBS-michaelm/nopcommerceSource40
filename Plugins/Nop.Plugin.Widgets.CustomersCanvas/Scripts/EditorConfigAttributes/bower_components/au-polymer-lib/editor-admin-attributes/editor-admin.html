<link rel="import" href="../../iron-signals/iron-signals.html">
<link rel="import" href="../../paper-button/paper-button.html">
<link rel="import" href="../../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../../paper-listbox/paper-listbox.html">
<link rel="import" href="../../paper-item/paper-item.html">
<link rel="import" href="editor-admin-design.html">
<link rel="import" href="editor-admin-design-folder.html">
<link rel="import" href="editor-admin-text.html">
<link rel="import" href="editor-admin-list.html">
<link rel="import" href="editor-admin-attributes.html">
<dom-module id="editor-admin">
    <template>
        <style>
        :host {
            display: block;
        }
        
        paper-button.green {
            background-color: #3c763d;
            color: white;
        }
        
        paper-button.red {
            background-color: #a94442;
            color: white;
        }
        
        paper-dropdown-menu {
            width: 300px;
        }
        
        .info-div {
            float: left;
            position: absolute;
            left: 50%;
        }
        
        .inlineblock {
            display: inline-block;
        }
        
        .loading {
            width: 30px;
            height: 30px;
            vertical-align: middle;
            background: url(data:image/gif;base64,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) no-repeat center;
        }
        </style>
        <iron-signals on-iron-signal-change-attribute="_changeAttribute"></iron-signals>
        <div id="editor-admin-main" style="text-align: center;">
            <div>
                <paper-dropdown-menu id="editor-dropdown" label="Select editor">
                    <paper-listbox id="editor-select" class="dropdown-content">
                        <template is="dom-repeat" items="[[editors]]">
                            <paper-item name="[[item.Title]]">[[item.Title]]</paper-item>
                        </template>
                    </paper-listbox>
                </paper-dropdown-menu>
            </div>
            <paper-dropdown-menu id="config-dropdown" label="Select config">
                <paper-listbox id="config-select" class="dropdown-content">
                    <template is="dom-repeat" items="[[configs]]">
                        <paper-item name="[[item.Title]]">[[item.Title]]</paper-item>
                    </template>
                </paper-listbox>
            </paper-dropdown-menu>
        </div>
        <editor-admin-attributes id="editor-admin-attributes" cc-url="{{ccUrl}}" default-values="{{defaultValues}}" style="text-align:center;"></editor-admin-attributes>
        <div>
            <paper-button raised class="custom" style="float:right;" id="btnSubmit" disabled on-tap="_submitButtonClick">Apply</paper-button>
            <div class="info-div" id="loader-div" style="visibility: hidden;">
                <div class="loading inlineblock"></div>
                <p class="inlineblock">
                    Waiting...
                </p>
            </div>
            <div class="info-div" style="visibility:hidden;" id="success-div">
                <p style="color: #3c763d"> <b> Success! </b></p>
            </div>
            <div class="info-div" style="visibility:hidden;" id="error-div">
                <p style="color: #a94442"> <b> Error! </b></p>
            </div>
            <paper-button raised class="custom" style="float: left;" disabled id="btnRemove" on-tap="_removeButtonClick" hidden$="{{_removeBtnInvisible}}">Unlink</paper-button>
        </div>
    </template>
    <script>
    Polymer({
        is: 'editor-admin',
        properties: {
            driver: {
                type: Object,
            },
            ccUrl: {
                type: String,
            },
            productId: {
                type: String,
            },
            productAttributes: {
                type: Object,
                value: {},
            },
            editors: {
                type: Array,
                value: []
            },
            configs: {
                type: Array,
                value: []
            },
            editorAttributeName: {
                type: String,
            },
            configAttributeName: {
                type: String,
            },
            selectedEditor: {
                type: Object,
                observer: "_selectedEditorChange"
            },
            selectedConfig: {
                type: Object,
                observer: "_selectedConfigChange"
            },
            initEditorValue: {
                type: String,
                value: "",
            },
            initConfigValue: {
                type: String,
                value: "",
            },
            defaultValues: {
                type: Array,
            },
            _removeBtnInvisible: {
                type: Boolean,
                notify: true,
                computed: '_removeBtnInvisible(driver)'
            },
        },

        attached: function() {
            var self = this;
            this._makePolyfills();

            var prevElem = self.previousElementSibling;
            if (prevElem != null && prevElem.id == 'loading') {
                prevElem.remove();
            } else {
                prevElem = self.previousSibling;
                if (prevElem != null && prevElem.id == 'loading') {
                    prevElem.remove();
                }
            }

            var elem = document.createElement(
                "editor-admin-attributes");
           

            var selectEditor = this.$["editor-select"];
            selectEditor.addEventListener("iron-select", function(e) {
                var title = e.detail.item.name;
                var selectedEditor = self.editors.find(
                    function(el) {
                        return el.Title == title;
                    });
                if (selectedEditor) {
                    self.selectedEditor = selectedEditor;
                }
            });

            var selectConfig = this.$["config-select"];
            selectConfig.addEventListener("iron-select", function(e) {
                var title = e.detail.item.name;
                var selectedConfig = self.selectedEditor.AllConfigs
                    .find(function(el) {
                        return el.Title == title;
                    });
                if (selectedConfig) {
                    self.selectedConfig = selectedConfig;
                }
            });

            if (self.initEditorValue) {
                self.editors.forEach(function(editor, index) {
                    if (editor.Title == self.initEditorValue) {
                        selectEditor.select(index);
                    }
                });
            }
            if (self.initConfigValue) {
                self.configs.forEach(function(config, index) {
                    if (config.Name == self.initConfigValue) {
                        selectConfig.select(index);
                    }
                });
            }
        },

        _selectedEditorChange: function(newValue, oldValue) {
            if (newValue) {
                var self = this;
                self.configs = newValue.AllConfigs;
                var selectConfig = this.$["config-select"];
                self._ClearAttributesDom();
                if (self.initConfigValue) {
                    self.configs.forEach(function(config, index) {
                        if (config.Name == self.initConfigValue) {
                            selectConfig.select(index);
                        }
                    });
                } else {
                    self.$["config-dropdown"]._setSelectedItem(null);
                }
            }
        },

        _ClearAttributesDom: function() {
            this.fire('iron-signal', {
                name: 'empty-attributes',
                data: null
            });
        },

        _selectedConfigChange: function(newValue, oldValue) {
            var self = this;
            if (newValue) {
                this.productAttributes = {};
                var editAttributes = this.$[
                    "editor-admin-attributes"];
                var config = newValue.Json;
                if (typeof(config) !== 'string') {
                    config = JSON.stringify(config);
                }
                editAttributes.editorConfig = config;
                self.enableApplyBtn();
                self.enableUnlinkBtn();
            }
        },

        enableApplyBtn: function() {
            this.$.btnSubmit.disabled = false;
            this.$.btnSubmit.classList.add("green");
        },

        enableUnlinkBtn: function() {
            this.$.btnRemove.disabled = false;
            this.$.btnRemove.classList.add("red");
        },

        disableApplyBtn: function() {
            this.$.btnSubmit.disabled = true;
            this.$.btnSubmit.classList.remove("green");
        },


        disableUnlinkBtn: function() {
            this.$.btnRemove.disabled = true;
            this.$.btnRemove.classList.remove("red");
        },


        _addEditorAndConfigAttributes: function() {
            if (this.selectedEditor) {
                this.productAttributes[this.editorAttributeName] = this.selectedEditor.Title;
            }
            if (this.selectedConfig) {
                this.productAttributes[this.configAttributeName] = this.selectedConfig.Name;
            }
        },

        _submitButtonClick: function() {
            this._showWaiting();
            this._addEditorAndConfigAttributes();
            if (typeof(this.driver.submitAttributes) === 'string') {
                eval("(" + this.driver.submitAttributes + ")(" +
                    this.productId + "," + JSON.stringify(this.productAttributes) +
                    ")");
            } else if (typeof(this.driver.submitAttributes) ===
                'function') {
                this.driver.submitAttributes(this.productId, this.productAttributes);
            }
        },

        _removeButtonClick: function() {
            var self = this;
            self._showWaiting();
            self._addEditorAndConfigAttributes();
            self._removeDomElements();
            self.selectedConfig = "";
            self.selectedEditor = "";
            self.disableApplyBtn();
            self.disableUnlinkBtn();
            if (typeof(self.driver.removeAttributes) === 'string') {
                eval("(" + this.driver.removeAttributes + ")(" +
                    selfs.productId + "," + JSON.stringify(self.productAttributes) +
                    ")");
            } else if (typeof(this.driver.removeAttributes) ===
                'function') {
                self.driver.removeAttributes(self.productId, self.productAttributes);
            }
        },

        _removeDomElements: function() {
            var self = this;
            // clear selectors
            var selectConfig = this.$["config-select"];
            selectConfig.select(-1);
            var selectEditor = this.$["editor-select"];
            selectEditor.select(-1);

            // remove dom
            self._ClearAttributesDom();

        },

        _removeBtnInvisible: function(driver) {
            if (!!driver) {
                if (!!driver.removeAttributes) {
                    if (typeof(driver.removeAttributes) ===
                        'function' || typeof(driver.removeAttributes) ===
                        'string') {
                        return false;
                    }
                }
            }
            return true;
        },

        _showWaiting: function() {
            this.$["success-div"].style.visibility = "hidden";
            this.$["error-div"].style.visibility = "hidden";
            this.$["loader-div"].style.visibility = "visible";
        },

        _hideWaiting: function() {
            this.$["loader-div"].style.visibility = "hidden";
        },

        _hideSuccess: function() {
            this.$["success-div"].style.visibility = "hidden";
        },

        _showSuccess: function() {
            var self = this;
            self._hideWaiting();
            self.$["success-div"].style.visibility = "visible";
            setTimeout(function() {
                self._hideSuccess();
            }, 5000);
        },

        _showError: function() {
            var self = this;
            this._hideWaiting();
            this.$["error-div"].style.visibility = "visible";
            setTimeout(function() {
                self._hideError();
            }, 6000);
        },

        _hideError: function() {
            this.$["error-div"].style.visibility = "hidden";
        },


        _changeAttribute: function(e) {
            var data = e.detail;
            this.productAttributes[data.name] = data.value;
        },

        _makePolyfills: function() {
            String.prototype.replaceAll = function(search, replace) {
                return this.split(search).join(replace);
            };

            (function(arr) {
                arr.forEach(function(item) {
                    if (item.hasOwnProperty('remove')) {
                        return;
                    }
                    Object.defineProperty(item, 'remove', {
                        configurable: true,
                        enumerable: true,
                        writable: true,
                        value: function remove() {
                            this.parentNode.removeChild(this);
                        }
                    });
                });
            })([Element.prototype, CharacterData.prototype, DocumentType.prototype]);
        },

        ping: function() {
            console.log(123);
        }
    });
    </script>
</dom-module>
